---
globs:
  - 'src/**/*.tsx'
  - 'src/**/*.ts'
alwaysApply: false
---

# Frontend Patterns

## Data Fetching with React Query

All data fetching uses `@tanstack/react-query` (React Query). Never use `fetch` or `axios` directly for Tauri commands.

### Query Pattern

```typescript
import { useQuery } from '@tanstack/react-query';
import { getMyData } from '@/generated/commands';
import type { MyDataType } from '@/generated/types';

export function useMyData() {
  return useQuery({
    queryKey: ['myData'],
    queryFn: async () => {
      return await getMyData();
    },
  });
}
```

### Query Keys

Use descriptive, hierarchical query keys:

- `["characters"]` - All characters
- `["skillQueue", characterId]` - Individual character skill queue
- `["character", characterId]` - Single character (if needed)

## Tauri Commands

Use auto-generated command functions from `@/generated/commands` instead of calling `invoke()` directly:

```typescript
import { getCharacters, logoutCharacter } from '@/generated/commands';

const characters = await getCharacters();
await logoutCharacter({ characterId: 123 });
```

Commands are defined in `src-tauri/src/commands/` directory, organized by domain. TypeScript bindings are auto-generated during build via `tauri-typegen` (see `src-tauri/build.rs`). Use `pnpm typegen` to refresh them manually without a full build.

## Custom Hooks

Custom hooks wrapping Tauri commands are located in `src/hooks/tauri/`. See that directory for available hooks.

### Hook Structure

All data-fetching hooks follow this pattern:

```typescript
import { useQuery } from '@tanstack/react-query';
import { getMyData } from '@/generated/commands';
import type { DataType } from '@/generated/types';

export function useMyData() {
  return useQuery<DataType[]>({
    queryKey: ['myData'],
    queryFn: async () => {
      return await getMyData();
    },
  });
}
```

For mutations (commands that modify state), use `useMutation`:

```typescript
import { useMutation, useQueryClient } from '@tanstack/react-query';
import { myMutation } from '@/generated/commands';
import type { InputType } from '@/generated/types';

export function useMyMutation() {
  const queryClient = useQueryClient();

  return useMutation({
    mutationFn: async (data: InputType) => {
      return await myMutation(data);
    },
    onSuccess: () => {
      queryClient.invalidateQueries({ queryKey: ['myData'] });
    },
  });
}
```

## Type Definitions

TypeScript types are auto-generated from Rust structs in `src/generated/types.ts`. These are generated during build via `tauri-typegen` and should not be edited manually. Use `pnpm typegen` to refresh them manually.

Import types from the generated module:

```typescript
import type { Character, CharacterSkillQueue } from '@/generated/types';
```

**Note**: The old `src/types/tauri.ts` file is deprecated. Use `@/generated/types` instead.

## Components

### shadcn/ui Components

- **Location**: `src/components/ui/`
- **Adding Components**: Always use the shadcn CLI: `pnpm dlx shadcn@latest add [component-name]`
- **Never manually create** shadcn component files

### Custom Components

- **Location**: `src/components/`
- **Naming**: PascalCase (e.g., `CharacterList.tsx`)
- **Structure**: Functional components with TypeScript

## Path Aliases

Configured in `components.json` and `tsconfig.json`:

- `@/components` → `src/components`
- `@/lib` → `src/lib`
- `@/hooks` → `src/hooks`
- `@/generated` → `src/generated`
- `@/components/ui` → `src/components/ui`

Use these aliases instead of relative paths:

```typescript
// Good
import { Button } from '@/components/ui/button';
import { useCharacters } from '@/hooks/tauri/useCharacters';

// Avoid
import { Button } from '../../components/ui/button';
```

## Styling

- **Framework**: Tailwind CSS
- **Config**: Tailwind v4 with CSS variables (see `src/index.css`)
- **Theme**: Uses shadcn/ui "new-york" style with slate base color
- **Icons**: Lucide React (`lucide-react`)

## Best Practices

- Always use React Query for data fetching
- Use custom hooks to encapsulate Tauri command invocations
- Use generated command functions from `@/generated/commands` instead of `invoke()` directly
- Invalidate queries after mutations to refresh data
- Use TypeScript types from `@/generated/types` for type safety
- Use path aliases for imports
- Use shadcn CLI to add UI components
- Follow React 19 patterns (functional components, hooks)
- Handle loading and error states from React Query
